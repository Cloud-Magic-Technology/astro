---
import Layout from '../layouts/Layout.astro';
import HydrationDemo from '../components/playground/HydrationDemo';
import HydrationStatus from '../components/playground/HydrationStatus.svelte';
import BundleVisualizer from '../components/playground/BundleVisualizer.astro';
import InfoBox from '../components/shared/InfoBox.astro';
import CodeBlock from '../components/shared/CodeBlock.astro';

const strategies = [
	{
		directive: 'client:load',
		description: 'Hydrates immediately on page load. Use for above-the-fold interactive content.',
	},
	{
		directive: 'client:idle',
		description: 'Hydrates when browser is idle. Good for lower-priority interactions.',
	},
	{
		directive: 'client:visible',
		description: 'Hydrates when scrolled into view. Perfect for below-the-fold content.',
	},
	{
		directive: 'client:media="(min-width: 768px)"',
		description: 'Hydrates only on larger screens. Ideal for desktop-only features.',
	},
];
---

<Layout title="Islands Playground | Astro Lab" description="Interactive demonstration of Astro's hydration strategies">
	<div class="mb-12">
		<h1 class="mb-4 bg-gradient-to-r from-amber-400 to-orange-500 bg-clip-text text-4xl font-bold text-transparent md:text-5xl">
			Islands Architecture Playground
		</h1>
		<p class="text-lg text-slate-300">
			Experience Astro's partial hydration in action. Each component below uses a different
			hydration strategy—watch the status indicators to see when they become interactive.
		</p>
	</div>

	<section class="mb-12">
		<InfoBox type="info" title="What is Partial Hydration?">
			Traditional frameworks hydrate the entire page with JavaScript. Astro's Islands Architecture
			lets you choose exactly which components need JavaScript and when they should load it.
			The result: dramatically smaller bundles and faster pages.
		</InfoBox>
	</section>

	<section class="mb-12">
		<h2 class="mb-6 text-2xl font-bold text-white">Hydration Strategies</h2>

		<div class="grid gap-4 md:grid-cols-2">
			<HydrationDemo
				client:load
				strategy="client:load"
				description="Hydrates immediately on page load. Use for above-the-fold interactive content."
			/>
			<HydrationDemo
				client:idle
				strategy="client:idle"
				description="Hydrates when browser is idle. Good for lower-priority interactions."
			/>
			<HydrationDemo
				client:visible
				strategy="client:visible"
				description="Hydrates when scrolled into view. Perfect for below-the-fold content."
			/>
			<HydrationDemo
				client:media="(min-width: 768px)"
				strategy='client:media="(min-width: 768px)"'
				description="Hydrates only on larger screens. Ideal for desktop-only features."
			/>
		</div>
	</section>

	<section class="mb-12">
		<h2 class="mb-6 text-2xl font-bold text-white">Cross-Framework Monitoring</h2>
		<div class="grid gap-4 md:grid-cols-2">
			<HydrationStatus client:load />
			<div class="rounded-lg border border-slate-700 bg-slate-800 p-4">
				<h3 class="mb-2 font-semibold text-blue-400">Static Astro Component</h3>
				<p class="text-sm text-slate-400">
					This component ships zero JavaScript. It's pure HTML rendered at build time.
					The buttons below are decorative—they don't work because there's no JS.
				</p>
				<div class="mt-3 flex gap-2">
					<button class="cursor-not-allowed rounded bg-slate-700 px-3 py-1.5 text-sm text-slate-500">
						Static -
					</button>
					<span class="flex items-center text-slate-600">0</span>
					<button class="cursor-not-allowed rounded bg-slate-700 px-3 py-1.5 text-sm text-slate-500">
						Static +
					</button>
				</div>
			</div>
		</div>
	</section>

	<section class="mb-12">
		<h2 class="mb-6 text-2xl font-bold text-white">The Code</h2>
		<CodeBlock title="Using Hydration Directives" lang="astro">
{`---
import Counter from './Counter.tsx';
---

<!-- Hydrate immediately -->
<Counter client:load />

<!-- Hydrate when idle -->
<Counter client:idle />

<!-- Hydrate when visible -->
<Counter client:visible />

<!-- Hydrate based on media query -->
<Counter client:media="(min-width: 768px)" />

<!-- Client-only (skip SSR) -->
<Counter client:only="react" />`}
		</CodeBlock>
	</section>

	<section class="mb-12">
		<h2 class="mb-6 text-2xl font-bold text-white">Bundle Impact</h2>
		<BundleVisualizer />
	</section>

	<section>
		<div class="rounded-xl border border-amber-500/30 bg-gradient-to-br from-amber-500/10 to-orange-500/10 p-6">
			<h2 class="mb-4 text-xl font-bold text-white">Key Takeaways</h2>
			<ul class="space-y-3 text-slate-300">
				<li class="flex items-start gap-2">
					<span class="text-amber-400">1.</span>
					<span><strong>Default is zero JS</strong> — Components render as static HTML unless you add a client directive.</span>
				</li>
				<li class="flex items-start gap-2">
					<span class="text-amber-400">2.</span>
					<span><strong>Granular control</strong> — Choose when each component hydrates based on its importance and position.</span>
				</li>
				<li class="flex items-start gap-2">
					<span class="text-amber-400">3.</span>
					<span><strong>Framework freedom</strong> — Mix React, Vue, Svelte, or any supported framework in the same page.</span>
				</li>
				<li class="flex items-start gap-2">
					<span class="text-amber-400">4.</span>
					<span><strong>Performance by default</strong> — Users get fast pages without you having to optimize manually.</span>
				</li>
			</ul>
		</div>
	</section>
</Layout>
