---
// Simulate fetching live stats from an API
// In production, this would call a real metrics endpoint
const simulateDelay = () => new Promise(resolve => setTimeout(resolve, 150));
await simulateDelay();

const stats = [
	{ label: 'Active Users', value: Math.floor(Math.random() * 500) + 1200, change: '+12%', positive: true },
	{ label: 'Page Views', value: Math.floor(Math.random() * 10000) + 45000, change: '+8%', positive: true },
	{ label: 'Bounce Rate', value: (Math.random() * 10 + 25).toFixed(1), change: '-3%', positive: true, suffix: '%' },
	{ label: 'Avg. Session', value: (Math.random() * 2 + 3).toFixed(1), change: '+5%', positive: true, suffix: 'm' },
];

const serverTime = new Date().toLocaleTimeString();
---

<div class="space-y-4">
	<div class="flex items-center justify-between">
		<h3 class="font-semibold text-white">Live Statistics</h3>
		<span class="flex items-center gap-1 text-xs text-green-400">
			<span class="h-2 w-2 animate-pulse rounded-full bg-green-400"></span>
			Live
		</span>
	</div>

	<div class="grid grid-cols-2 gap-3">
		{stats.map((stat) => (
			<div class="rounded-lg bg-slate-900 p-3">
				<p class="text-xs text-slate-400">{stat.label}</p>
				<p class="text-xl font-bold text-white">
					{typeof stat.value === 'number' && stat.value > 1000
						? (stat.value / 1000).toFixed(1) + 'k'
						: stat.value}
					{stat.suffix || ''}
				</p>
				<p class={`text-xs ${stat.positive ? 'text-green-400' : 'text-red-400'}`}>
					{stat.change}
				</p>
			</div>
		))}
	</div>

	<p class="text-center text-xs text-slate-500">
		Server time: {serverTime}
	</p>
</div>
